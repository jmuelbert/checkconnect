May u rewrite the tests for the run function? BTW: Add and renew docstrings. All in english. Complete docstrings respects the python policies. Change comments to English: 